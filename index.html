<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/javascript" src="https://admin.tago.io/dist/custom-widget.min.js"></script>
  <title>My Widget</title>
  <style>
    #send-data-button {
      display: none; /* Inicia oculto */
    }
  </style>
</head>
<body>
  <button id="send-data-button" onclick="sendData()">
    Send data
  </button>

  <script>
    function sendData() {
      var data = {
        variable: "my_variable2",
        value: Math.random(),
      };
      window.TagoIO.sendData(data);
    }

    // --- Nova FunÃ§Ã£o para Manipular a Visibilidade ---
    function updateButtonVisibility(flag_value) {
      const button = document.getElementById('send-data-button');
      
      // Converte o valor para nÃºmero e verifica se Ã© 1
      if (flag_value == 1) {
        button.style.display = 'block'; // Torna visÃ­vel
      } else {
        button.style.display = 'none'; // Torna invisÃ­vel
      }
    }
    // -------------------------------------------------

    window.TagoIO.onStart((widget) => {
      window.widget = widget;
      const display = widget.display;
      const parameters = display.parameters;

      
      // ðŸ”„ Adicione um listener para quando o TagoIO enviar novos dados
      // Este mÃ©todo Ã© chamado toda vez que os dados na Dashboad/Widget sÃ£o atualizados
      widget.onDataUpdate((data) => {
        // ðŸ”Ž Procura o valor da variÃ¡vel 'habilite_flag' nos dados
        
        const flagData = (parameters[0] === 'habilite_flag') ? 0 : 1;
       


        if (flagData && flagData.value !== undefined) {
          // Chama a funÃ§Ã£o para atualizar a visibilidade
          updateButtonVisibility(flagData.value);
        }
      });
    });

  </script>

  <script>
    window.TagoIO.ready();
  </script>
</body>
</html>
