
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/javascript" src="https://admin.tago.io/dist/custom-widget.min.js"></script>
  <title>My Widget</title>
  <style>
    #send-data-button {
      display: none; /* Inicia oculto */
    }
  </style>
</head>
<body>
  <button id="send-data-button" onclick="sendData()">
    Send data
  </button>

  <script>
    function sendData() {
      var data = {
        variable: "my_variable2",
        value: Math.random(),
      };
      window.TagoIO.sendData(data);
    }

    // --- Nova Fun√ß√£o para Manipular a Visibilidade ---
    function updateButtonVisibility(flag_value) {
      const button = document.getElementById('send-data-button');
      
      // Converte o valor para n√∫mero e verifica se √© 1
      if (flag_value == 1) {
        button.style.display = 'block'; // Torna vis√≠vel
      } else {
        button.style.display = 'none'; // Torna invis√≠vel
      }
    }
    // -------------------------------------------------

    window.TagoIO.onStart((widget) => {
      window.widget = widget;
      
      // üîÑ Adicione um listener para quando o TagoIO enviar novos dados
      // Este m√©todo √© chamado toda vez que os dados na Dashboad/Widget s√£o atualizados
      widget.onDataUpdate((data) => {
        // üîé Procura o valor da vari√°vel 'habilite_flag' nos dados
        const flagData = data.find(item => item.variable === 'habilite_flag');

        if (flagData && flagData.value !== undefined) {
          // Chama a fun√ß√£o para atualizar a visibilidade
          updateButtonVisibility(flagData.value);
        }
      });
    });

  </script>

  <script>
    window.TagoIO.ready();
  </script>
</body>
</html>
